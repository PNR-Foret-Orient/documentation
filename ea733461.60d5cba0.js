(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{77:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return s})),a.d(t,"metadata",(function(){return o})),a.d(t,"rightToc",(function(){return c})),a.d(t,"default",(function(){return b}));var n=a(2),r=a(6),l=(a(0),a(85)),i=a(86),s={title:"Donn\xe9es de l'Atlas",sidebar_label:"Donn\xe9es"},o={unversionedId:"atlasDonnees",id:"atlasDonnees",isDocsHomePage:!1,title:"Donn\xe9es de l'Atlas",description:"Cette page concerne les donn\xe9es de l'Atlas, c'est-\xe0-dire les donn\xe9es naturalistes qui proviennent de la BDD m\xe8re GeoNature. Pour vous renseigner sur les images et le texte des pages sur l'Atlas, merci de vous rendre sur la page Contenu de l'Atlas.",source:"@site/docs/atlasDonnees.md",slug:"/atlasDonnees",permalink:"/documentation/atlasDonnees",editUrl:"https://github.com/PNR-Foret-Orient/documentation/edit/master/docs/atlasDonnees.md",version:"current",sidebar_label:"Donn\xe9es",sidebar:"sidebar",previous:{title:"Contenu de l'Atlas",permalink:"/documentation/atlasContenu"},next:{title:"GeoNature Citizen",permalink:"/documentation/citizenApercu"}},c=[{value:"Quelles sont les donn\xe9es visibles sur l&#39;Atlas ?",id:"quelles-sont-les-donn\xe9es-visibles-sur-latlas-",children:[]},{value:"D\xe9gradation des donn\xe9es",id:"d\xe9gradation-des-donn\xe9es",children:[]},{value:"Mises \xe0 jour automatiques",id:"mises-\xe0-jour-automatiques",children:[]},{value:"Lancer une mise \xe0 jour manuellement",id:"lancer-une-mise-\xe0-jour-manuellement",children:[]}],u={rightToc:c};function b(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(l.b)("wrapper",Object(n.a)({},u,a,{components:t,mdxType:"MDXLayout"}),Object(l.b)("p",null,"Cette page concerne les ",Object(l.b)("em",{parentName:"p"},"donn\xe9es")," de l'Atlas, c'est-\xe0-dire les donn\xe9es naturalistes qui proviennent de la BDD m\xe8re GeoNature. Pour vous renseigner sur les images et le texte des pages sur l'Atlas, merci de vous rendre sur la page ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/documentation/atlasContenu"}),"Contenu de l'Atlas"),"."),Object(l.b)("img",{alt:"Capture d'\xe9cran de la pr\xe9sentation de GeoNature-Atlas",src:Object(i.a)("img/docs/geonatureAtlas4.png"),className:"tablet"}),Object(l.b)("p",null,Object(l.b)("em",{parentName:"p"},"La carte de la page d'accueil")),Object(l.b)("h2",{id:"quelles-sont-les-donn\xe9es-visibles-sur-latlas-"},"Quelles sont les donn\xe9es visibles sur l'Atlas ?"),Object(l.b)("p",null,"Pour info, l'Atlas :"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"filtre les donn\xe9es non-diffusable (avec le code \xab 4\xa0\xbb) - ",Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/PnX-SI/GeoNature-atlas/blob/3e595c81db9e0490cf4367b024cc97defd3a9668/data/gn2/atlas_synthese.sql#L35"}),"voir le code")),Object(l.b)("li",{parentName:"ul"},"inclut seulement les donn\xe9es \xab pr\xe9sentes \xbb (avec le code \xab Pr \xbb) - ",Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/PnX-SI/GeoNature-atlas/blob/3e595c81db9e0490cf4367b024cc97defd3a9668/data/gn2/atlas_synthese.sql#L36"}),"voir le code")),Object(l.b)("li",{parentName:"ul"},"inclut seulement les donn\xe9es dans le territoire du parc - ",Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/PnX-SI/GeoNature-atlas/blob/3e595c81db9e0490cf4367b024cc97defd3a9668/data/atlas.sql#L33"}),"voir le code"))),Object(l.b)("div",{className:"admonition admonition-info alert alert--info"},Object(l.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(l.b)("h5",{parentName:"div"},Object(l.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(l.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(l.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"info")),Object(l.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(l.b)("p",{parentName:"div"},"Le \xab territoire \xbb correspond aux donn\xe9es qui se trouvent dans la table ",Object(l.b)("inlineCode",{parentName:"p"},"ref_geo.l_areas")," de ",Object(l.b)("inlineCode",{parentName:"p"},"geonature2db")," avec le type \xab (15) Parcs naturels r\xe9gionaux \xbb. Si vous voulez mettre \xe0 jour le p\xe9rim\xe8tre (ex. l\u2019\xe9largissement du parc), vous devez modifier les donn\xe9es g\xe9ospatiales dans cette table puis ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"#lancer-une-mise-%C3%A0-jour-manuellement"}),"actualiser les vues materialis\xe9es"),"."))),Object(l.b)("h2",{id:"d\xe9gradation-des-donn\xe9es"},"D\xe9gradation des donn\xe9es"),Object(l.b)("p",null,"Selon la documentation officielle, \xab GeoNature-atlas fournit un m\xe9canisme de d\xe9gration des donn\xe9es bas\xe9 sur les standards du SINP. Connect\xe9 \xe0 GeoNature version 2, l'atlas utilise le champs ",Object(l.b)("inlineCode",{parentName:"p"},"id_nomenclature_diffusion_level")," de la table ",Object(l.b)("inlineCode",{parentName:"p"},"gn_synthese.synthese")," pour construire la vue atlas.vm_observations et remplir la g\xe9ometrie adapt\xe9e en se basant sur r\xe9f\xe9rentiel g\xe9ographique de GeoNature. Pour des raisons de performance et de lisibilit\xe9, GeoNature-atlas affiche le centro\xefde de la g\xe9ometrie \xe0 laquelle l'observation est d\xe9grad\xe9e. \xbb"),Object(l.b)("p",null,"\xc0 partir des donn\xe9es bruts pr\xe9sentes dans GeoNature, l'atlas applique le floutage suivant :"),Object(l.b)("table",null,Object(l.b)("thead",{parentName:"table"},Object(l.b)("tr",{parentName:"thead"},Object(l.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Niveau"),Object(l.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Visible?"),Object(l.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Description"))),Object(l.b)("tbody",{parentName:"table"},Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"0"),Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Oui"),Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Diffusion standard")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"1"),Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Oui"),Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Diffusion flout\xe9e de la DEE par rattachement \xe0 la commune")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"2"),Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Oui"),Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Diffusion flout\xe9e par rattachement \xe0 la maille 10 x 10 km")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"3"),Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Non"),Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Diffusion flout\xe9e par rattachement au d\xe9partement")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"4"),Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Non"),Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Aucune diffusion (cas exceptionnel), correspond \xe0 une donn\xe9e de sensibilit\xe9 4")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"5"),Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Oui"),Object(l.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Diffusion telle quelle : si une donn\xe9e pr\xe9cise existe, elle doit \xeatre diffus\xe9e telle quelle (non d\xe9grad\xe9e)")))),Object(l.b)("div",{className:"admonition admonition-caution alert alert--warning"},Object(l.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(l.b)("h5",{parentName:"div"},Object(l.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(l.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"}),Object(l.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})))),"caution")),Object(l.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(l.b)("p",{parentName:"div"},"Les donn\xe9es au niveau 3 ne seront pas visibles car le centro\xefde du d\xe9partement ne se trouve pas sur le territoire du parc."))),Object(l.b)("p",null,"Pour en savoir plus, lisez la ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/PnX-SI/GeoNature-atlas/blob/master/docs/degradation_donnees.rst"}),"documentation officielle"),"."),Object(l.b)("h2",{id:"mises-\xe0-jour-automatiques"},"Mises \xe0 jour automatiques"),Object(l.b)("p",null,"Cette configuration de GeoNature-Atlas permet d'actualiser automatiquement les \xab vues materialis\xe9es \xbb de la BDD m\xe8re. La mise \xe0 jour se fait toutes les heures, grace au ",Object(l.b)("inlineCode",{parentName:"p"},"crontab")," :"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{}),'postgres@sig:~$ crontab -l\n\u2026\n# m h  dom mon dow   command\n0 * * * * psql -d geonatureatlas -c "SELECT atlas.refresh_materialized_view_data();"\n')),Object(l.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(l.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(l.b)("h5",{parentName:"div"},Object(l.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(l.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(l.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(l.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(l.b)("p",{parentName:"div"},"Le processus automatique n'applique que les donn\xe9es naturalistes. Pour rafraichir les donn\xe9es g\xe9ographiques vous devez le faire manuellement."))),Object(l.b)("h2",{id:"lancer-une-mise-\xe0-jour-manuellement"},"Lancer une mise \xe0 jour manuellement"),Object(l.b)("p",null,"Pour mettre \xe0 jour l'atlas manuellement, vous devez vous connecter \xe0 la BDD puis lancer les commandes suivantes :"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{}),"SELECT atlas.refresh_materialized_view_data(); -- actualiser les donn\xe9es naturalistes\nSELECT atlas.refresh_materialized_view_ref_geo(); -- actualiser les donn\xe9es g\xe9ographiques\n")),Object(l.b)("p",null,"Pour en savoir plus, ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/PnX-SI/GeoNature-atlas/blob/master/docs/vues_materialisees_maj.rst#mise-%C3%A0-jour-des-vues-mat%C3%A9rialis%C3%A9es"}),"lisez la documentation officielle")))}b.isMDXComponent=!0},84:function(e,t,a){"use strict";var n=a(0),r=a(20);t.a=function(){var e=Object(n.useContext)(r.a);if(null===e)throw new Error("Docusaurus context not provided");return e}},85:function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return p}));var n=a(0),r=a.n(n);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var c=r.a.createContext({}),u=function(e){var t=r.a.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},b=function(e){var t=u(e.components);return r.a.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,l=e.originalType,i=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),b=u(a),m=n,p=b["".concat(i,".").concat(m)]||b[m]||d[m]||l;return a?r.a.createElement(p,s(s({ref:t},c),{},{components:a})):r.a.createElement(p,s({ref:t},c))}));function p(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=a.length,i=new Array(l);i[0]=m;var s={};for(var o in t)hasOwnProperty.call(t,o)&&(s[o]=t[o]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var c=2;c<l;c++)i[c]=a[c];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,a)}m.displayName="MDXCreateElement"},86:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return i}));var n=a(84),r=a(87);function l(){var e=Object(n.a)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,a=void 0===t?"/":t,l=e.url;return{withBaseUrl:function(e,t){return function(e,t,a,n){var l=void 0===n?{}:n,i=l.forcePrependBaseUrl,s=void 0!==i&&i,o=l.absolute,c=void 0!==o&&o;if(!a)return a;if(a.startsWith("#"))return a;if(Object(r.b)(a))return a;if(s)return t+a;var u=!a.startsWith(t)?t+a.replace(/^\//,""):a;return c?e+u:u}(l,a,e,t)}}}function i(e,t){return void 0===t&&(t={}),(0,l().withBaseUrl)(e,t)}},87:function(e,t,a){"use strict";function n(e){return!0===/^(\w*:|\/\/)/.test(e)}function r(e){return void 0!==e&&!n(e)}a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}))}}]);